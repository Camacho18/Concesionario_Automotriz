@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<!--[I] PromocionList-->
<br />
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-body">
                <div class="row col-12">
                    <button class="btn btn-primary col-2" id="Btn_NewVenta">Nuevo +</button>
                    <h5 class="col-8 text-center">Ventas</h5>
                    <div class="col-2"></div>
                </div>
                <br />
                <div class="">
                    @Html.EJS().Grid("Grid_VentaAuto").AllowResizing(true).AllowSorting().AllowFiltering().Columns(col =>
               {
                   col.Field("IdVentaAuto").TextAlign(Syncfusion.EJ2.Grids.TextAlign.Center).Visible(false).Add();
                   col.Field("Numero").HeaderText("Número de Venta").TextAlign(Syncfusion.EJ2.Grids.TextAlign.Center).Add();
                   col.Field("Usuario").HeaderText("Empleado responsable").TextAlign(Syncfusion.EJ2.Grids.TextAlign.Center).Add();
                   col.Field("Cliente").HeaderText("Cliente").TextAlign(Syncfusion.EJ2.Grids.TextAlign.Center).Add();
                   col.Field("EstadoVenta").HeaderText("Estado de la venta").TextAlign(Syncfusion.EJ2.Grids.TextAlign.Center).Add();
                   col.HeaderText("Opciones").Template("#templateVenta").TextAlign(Syncfusion.EJ2.Grids.TextAlign.Center).Add();
               }).AllowPaging().SelectionSettings(select => select.Type(Syncfusion.EJ2.Grids.SelectionType.Single)).PageSettings(page => page.PageCount(5).PageSize(4)).Render()
                </div>

            </div>
        </div>
    </div>
</div>
<style>
    .e-grid .e-headercell {
        background-color: #eeeeee;
    }

    .e-grid .e-gridheader {
        color: black;
    }
</style>

<script id="templateVenta" type="text/x-template">
    <div class="row text-center">
        <div class="col-md-12 ">
            <div class="">
                <a class="text-succcess" href="javascript:void(0)" onclick="RowSelectVenta(${IdVentaAuto})" data-toggle="tooltip" data-placement="top" title="Detalles">
                    <i class="fa fa-eye"></i>
                </a>
                ${if(Estado=="Creado")}
                @*<a class="text-danger" style="padding:0px,5px,0px,5px; margin-left:10px; margin-right:10px" href="javascript:void(0)" onclick="Cancelar(${ IdVentaAuto })" data-toggle="tooltip" data-placement="top" title="Cancelar">
                        <i class="fa fa-remove"></i>
                    </a>
                    <a class="text-succcess" href="javascript:void(0)" onclick="Pagar(${IdVentaAuto})" data-toggle="tooltip" data-placement="top" title="Marcar como pagado">
                        <i class="fa fa-money"></i>
                    </a>*@
                ${else}

                ${/if}
            </div>
        </div>
    </div>
</script>

<!--[F] PromocionList-->
<!--[I] PromocionAuto-->
<br />
@*<div id="viewAutoC" class="row" hidden>
        <div class="col-12">
            <div class="card">
                <div class="card-body">

                    <div class="row col-12">
                        <h5 class="col-12 text-center">Autos del cliente</h5>
                    </div>
                    <br />
                    <div class="row col-12">
                        <button class="btn btn-primary col-2" id="Btn_NewVentaC">Nuevo +</button>
                        <div class="col-8 text-center"><h6 id="num"></h6></div>
                        <div class="col-2"></div>
                    </div>
                    <br />
                    <div class="">
                        @Html.EJS().Grid("Grid_AutoCliente").AllowResizing(true).AllowSorting().AllowFiltering().Columns(col =>
                   {
                       col.Field("IdAutoCliente").TextAlign(Syncfusion.EJ2.Grids.TextAlign.Center).Visible(false).Add();
                       col.Field("Numero").HeaderText("Número de Auto").TextAlign(Syncfusion.EJ2.Grids.TextAlign.Center).Add();
                       col.Field("PrecioVenta").HeaderText("Precio").TextAlign(Syncfusion.EJ2.Grids.TextAlign.Center).Add();
                       col.Field("Marca").HeaderText("Marca").TextAlign(Syncfusion.EJ2.Grids.TextAlign.Center).Add();
                       col.Field("Modelo").HeaderText("Modelo").TextAlign(Syncfusion.EJ2.Grids.TextAlign.Center).Add();
                       col.Field("Color").HeaderText("Estado").TextAlign(Syncfusion.EJ2.Grids.TextAlign.Center).Add();
                       col.Field("Anio").HeaderText("Año").TextAlign(Syncfusion.EJ2.Grids.TextAlign.Center).Add();
                       col.HeaderText("Opciones").Template("#templateVentaC").TextAlign(Syncfusion.EJ2.Grids.TextAlign.Center).Add();
                   }).AllowPaging().SelectionSettings(select => select.Type(Syncfusion.EJ2.Grids.SelectionType.Single)).PageSettings(page => page.PageCount(7).PageSize(4)).Render()
                    </div>
                </div>
            </div>
        </div>
    </div>*@

    @*<script id="templateVentaC" type="text/x-template">
        <div class="row text-center">
            <div class="col-md-12 ">
                <div class="">
                    <a class="text-danger" style="padding:0px,5px,0px,5px; margin-left:10px; margin-right:10px" href="javascript:void(0)" onclick="Deleteauto(${ IdAutocliente })" data-toggle="tooltip" data-placement="top" title="Eliminar">
                        <i class="fa fa-remove"></i>
                    </a>
                </div>
            </div>
        </div>
    </script>*@
<!--[I] PromocionAuto-->
<div class="modal fade" id="VentaModal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div id="frmVenta">

            </div>

        </div>
    </div>
</div>

<script>

    //[I] PromocionList
    $(function () { VentaAutoLoad(); })

    function VentaAutoLoad() {
            $.get('@Url.Action("VentaAutoJson", "VentaAuto")', function (data) {
            var grid = document.getElementById('Grid_VentaAuto').ej2_instances[0]; // Grid instance
            grid.dataSource = JSON.parse(data);
            });
            }

            $('#Btn_NewVenta').click(function () {

            $.get('@Url.Action("CreateVentaAuto", "VentaAuto")', function (data) {
            $('#frmVenta').html(data);
            $('#VentaModal').modal("show");
            });
            });

            @*function RowSelectVentaAuto(IdVentaAuto) {
                    $.get('@Url.Action("AutoClienteJson","VentaAuto", new { IdVentaAuto = "_id_" })'.replace('_id_', IdVentaAuto), function (data) {
                        $("#viewAutoC").removeAttr("hidden");
                        var grid = document.getElementById('Grid_AutoCliente').ej2_instances[0]; // Grid instance
                        grid.dataSource = JSON.parse(data.JsonString);
                        var text ="Venta del cliente:" +" "+ data.num;
                        $('#num').text(text);
                    });
                }*@
            function RowSelectVenta(Id) {
            $(location).attr('href', '/VentaAuto/Options' + '?Id=' + Id);

            }


            //[F] PromocionList

            //[I] Accesorio

            @*function AutoClienteLoad() {

                        $.get('@Url.Action("AutoClienteJson","VentaAuto")', function (data) {
                            $("#viewAutoC").removeAttr("hidden");
                            var grid = document.getElementById('Grid_AutoCliente').ej2_instances[0]; // Grid instance
                            grid.dataSource = JSON.parse(data.JsonString);
                            var text = "Venta del cliente:" + " " + data.num;
                            $('#num').text(text);
                        });
                    }
                function RowClearSelect() { $("#viewAutoC").attr("hidden", true); }

                $('#Btn_NewVentaC').click(function () {
                         $.get('@Url.Action("CreateAutoCliente","VentaAuto")', function (data) {
                             $('#frmVenta').html(data);
                             $('#VentaModal').modal("show");
                            });
                    });*@

            @*function DeleteVenta(id) {
                Swal.fire({
                position: "top",
                title: 'Eliminar',
                text: "Desea eliminar la promoción!",
                icon: 'warning',
                showCancelButton: true,
                showConfirmButton: true,
                cancelButtonColor: '#d33',
                confirmButtonColor: '#3085d6',
                cancelButtonText: 'Cancelar',
                confirmButtonText: 'Eliminar',
                reverseButtons: true
                }).then((result) => {
                if (result.value) {
                $.get('@Url.Action("DeleteVenta", "VentaAuto", new { Id = "_ID_" })'.replace('_ID_', id), function (data) {
                VentaAutoLoad();
                if (data == 2) {
                Swal.fire({
                position: "top",
                title: "Venta Aplicada",
                text: "No se puede eliminar",
                icon: "warning",
                button: "Aceptar",
                });
                } else if (data == 1) {
                Swal.fire({
                position: "top",
                title: "Correcto",
                text: "Venta Eliminada",
                icon: "success",
                button: "Aceptar",
                });
                } else {
                Swal.fire({
                position: "top",
                title: "Error",
                text: "Error No Reconocido",
                icon: "warning",
                button: "Aceptar",
                });
                }
                });
                }
                })
                };*@

            //[F] Accesorio

            </script>


